<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>raceland: R package for a pattern-based, zoneless method for analysis and visualization of racial topography • raceland</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css" integrity="sha256-eZrrJcwDc/3uDhsdt61sL2oOBY362qM3lon1gyExkL0=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- sticky kit --><script src="https://cdnjs.cloudflare.com/ajax/libs/sticky-kit/1.1.3/sticky-kit.min.js" integrity="sha256-c4Rlo1ZozqTPE2RLuvbusY3+SU1pQaJC0TjuhygMipw=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="raceland: R package for a pattern-based, zoneless method for analysis and visualization of racial topography">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">raceland</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.9.9</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fa fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/raceland-intro.html">raceland: R package for a pattern-based, zoneless method for analysis and visualization of racial topography</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      
      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>raceland: R package for a pattern-based, zoneless method for analysis and visualization of racial topography</h1>
                        <h4 class="author">Anna Dmowska, Tomasz Stepinski, Jakub Nowosad</h4>
            
            <h4 class="date">2019-08-24</h4>
      
      
      <div class="hidden name"><code>raceland-intro.Rmd</code></div>

    </div>

    
    
<div id="introduction" class="section level1">
<h1 class="hasAnchor">
<a href="#introduction" class="anchor"></a>INTRODUCTION</h1>
<p>The <strong>raceland</strong> package implements a computational framework for a pattern-based, zoneless analysis and visualization of (ethno)racial topography. It is a reimagined approach for analyzing residential segregation and racial diversity based on the concept of ‘landscape’ used in the domain of landscape ecology.</p>
<p>The proposed approach adopts a bird’s view perspective - in which visualization and quantification of racial topography (an overall organization of a spatial pattern formed by locations of people of different races) are tightly intertwined by using the same data - a high-resolution raster grid with each cell containing only inhabitants of a single race. Such grids represent <strong><em>a racial landscape (RL).</em></strong> A <em>racial landscape (RL)</em> consists of the mosaic of many large and small patches (racial enclaves) formed by adjacent raster grid cells having the same race categories. The distribution of racial enclaves creates a specific spatial pattern.</p>
<p>The racial landscape is described by <em>exposure matrix</em> and quantified by two metrics (entropy and mutual information) derived from Information Theory concept (IT). Entropy is the measure of racial diversity and mutual information measures racial segregation.</p>
<p><strong>Racial landscape method</strong> is based on the raster gridded data, and unlike the previous methods, does not depend on the division for specific zones (census tract, census block, etc.). Calculation of racial diversity (entropy) and racial segregation (mutual information) can be performed for the whole area of interests (i.e., metropolitan area) without introducing any arbitrary divisions. Racial landscape method also allows for performing the calculation at different spatial scales.</p>
</div>
<div id="a-computational-framework" class="section level1">
<h1 class="hasAnchor">
<a href="#a-computational-framework" class="anchor"></a>A COMPUTATIONAL FRAMEWORK</h1>
<p>A computational framework implemented in the <strong>raceland</strong> package allows for:</p>
<ol style="list-style-type: decimal">
<li><p>Constructing racial landscape based on race-specific raster grids.</p></li>
<li><p>Describing the racial pattern of a racial landscape at different scales or/and for the whole area of interests using metrics derived from Information Theory concept (entropy and mutual information).</p></li>
<li><p>Mapping the racial landscape.</p></li>
<li><p>Mapping racial diversity and segregation at different scales.</p></li>
</ol>
<p>A computational framework consists of the four steps (see figure below, the blue font indicates the names of function from the <strong>raceland</strong> package).</p>
<p><img src="fig0framework.png" width="800"></p>
<div id="input-data" class="section level2">
<h2 class="hasAnchor">
<a href="#input-data" class="anchor"></a>Input data</h2>
<p>Racial landscape method is based on high-resolution race-specific raster grids. Each cell in race-specific grids contains race subpopulation density. SocScape project provides high-resolution raster grids for 1990, 2000, 2010 years for 365 metropolitan areas and each county in the conterminous US. Data is available at <a href="http://sil.uc.edu/cms/index.php?id=socscape-data" class="uri">http://sil.uc.edu/cms/index.php?id=socscape-data</a>.</p>
<p>The calculation can also be performed using a spatial vector file (e.g., shapefile) with attribute table containing race counts for aggregated data. In such case, a spatial vector object is first rasterized using the <code>zones_to_rasters()</code> function from the <strong>raceland</strong> package (people of a given race are redistributed to the cells by dividing the number of people by the number of cells belonging to the particular spatial units).</p>
<p>Please notice that the rasterization time depends on the number of divisions and for large areas (i.e., metropolitan areas) can be time-consuming. It is recommended to use the smallest available divisions.</p>
<p>Here we demonstrate a computational framework using an example of the area of 60x60 cells. The input data is a high-resolution (30m) raster grids. Race-specific rasters are stored as GeoTIFFs (the directory contains five files for five race-groups: Asians, Blacks, Hispanic, others and Whites).</p>
<p>The RasterStack with race-specific grids is created based on the GeoTIFF files (files will be sorted and read into RasterStack in alphabetical order; the categories in the racial landscape will depend on the order of layers in input data - see details in the next section).</p>
<div id="working-with-high-resolution-grids" class="section level3">
<h3 class="hasAnchor">
<a href="#working-with-high-resolution-grids" class="anchor"></a>Working with high resolution grids</h3>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" data-line-number="1">list_raster =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/list.files">list.files</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.file">system.file</a></span>(<span class="st">"rast_data"</span>, <span class="dt">package =</span> <span class="st">"raceland"</span>),</a>
<a class="sourceLine" id="cb1-2" data-line-number="2">                         <span class="dt">full.names =</span> <span class="ot">TRUE</span>)</a></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" data-line-number="1">race_raster =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/stack">stack</a></span>(list_raster)</a>
<a class="sourceLine" id="cb2-2" data-line-number="2">race_raster</a>
<a class="sourceLine" id="cb2-3" data-line-number="3"><span class="co">#&gt; class      : RasterStack </span></a>
<a class="sourceLine" id="cb2-4" data-line-number="4"><span class="co">#&gt; dimensions : 60, 60, 3600, 5  (nrow, ncol, ncell, nlayers)</span></a>
<a class="sourceLine" id="cb2-5" data-line-number="5"><span class="co">#&gt; resolution : 30, 30  (x, y)</span></a>
<a class="sourceLine" id="cb2-6" data-line-number="6"><span class="co">#&gt; extent     : 685545, 687345, 2103255, 2105055  (xmin, xmax, ymin, ymax)</span></a>
<a class="sourceLine" id="cb2-7" data-line-number="7"><span class="co">#&gt; crs        : +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=23 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +towgs84=0,0,0,0,0,0,0 +units=m +no_defs </span></a>
<a class="sourceLine" id="cb2-8" data-line-number="8"><span class="co">#&gt; names      :      asian,      black,   hispanic,      other,      white </span></a>
<a class="sourceLine" id="cb2-9" data-line-number="9"><span class="co">#&gt; min values :          0,          0,          0,          0,          0 </span></a>
<a class="sourceLine" id="cb2-10" data-line-number="10"><span class="co">#&gt; max values :  1.3333334, 15.3125000,  9.6666670,  0.5714286,  3.7500000</span></a></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(race_raster)</a></code></pre></div>
<p><img src="raceland-intro_files/figure-html/fig1-1.png" width="80%" style="display: block; margin: auto;"></p>
</div>
<div id="working-with-vector-data" class="section level3">
<h3 class="hasAnchor">
<a href="#working-with-vector-data" class="anchor"></a>Working with vector data</h3>
<p>While using spatial vector data, the file should be read to R using the <code>st_read()</code> function from the <strong>sf</strong> package. In the next step spatial object is rasterized using <code>zones_to_rasters()</code> from the <strong>raceland</strong> package.</p>
<p>Function <code>zones_to_rasters()</code> requires three arguments:</p>
<ul>
<li>
<code>v</code> - an sf object with aggregated attribute data</li>
<li>
<code>resolution</code> - a resolution of the output raster (below we use <code>resolution=30</code>, which is the same resolution as used in the SocScape grids)</li>
<li>
<code>variables</code> - a character vector with columns names from <em>v</em>. The values from these columns will be (1) rasterized and (2) recalculated to densities. Each column will be represented as a layer in the output RasterStack.</li>
</ul>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" data-line-number="1">pf_to_data =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/system.file">system.file</a></span>(<span class="st">"vect_data/block_data.gpkg"</span>, <span class="dt">package =</span> <span class="st">"raceland"</span>)</a></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb5-1" data-line-number="1">vect_data =<span class="st"> </span><span class="kw">st_read</span>(pf_to_data)</a>
<a class="sourceLine" id="cb5-2" data-line-number="2"><span class="co">#&gt; Reading layer `block_data' from data source `/home/travis/R/Library/raceland/vect_data/block_data.gpkg' using driver `GPKG'</span></a>
<a class="sourceLine" id="cb5-3" data-line-number="3"><span class="co">#&gt; Simple feature collection with 264 features and 6 fields</span></a>
<a class="sourceLine" id="cb5-4" data-line-number="4"><span class="co">#&gt; geometry type:  POLYGON</span></a>
<a class="sourceLine" id="cb5-5" data-line-number="5"><span class="co">#&gt; dimension:      XY</span></a>
<a class="sourceLine" id="cb5-6" data-line-number="6"><span class="co">#&gt; bbox:           xmin: 685545 ymin: 496468.7 xmax: 687345 ymax: 498268.7</span></a>
<a class="sourceLine" id="cb5-7" data-line-number="7"><span class="co">#&gt; epsg (SRID):    NA</span></a>
<a class="sourceLine" id="cb5-8" data-line-number="8"><span class="co">#&gt; proj4string:    +proj=aea +lat_1=29.5 +lat_2=45.5 +lat_0=37.5 +lon_0=-96 +x_0=0 +y_0=0 +ellps=GRS80 +units=m +no_defs</span></a></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(vect_data)</a>
<a class="sourceLine" id="cb6-2" data-line-number="2"><span class="co">#&gt; [1] "GISJOIN"  "ASIAN"    "BLACK"    "HISPANIC" "OTHER"    "WHITE"   </span></a>
<a class="sourceLine" id="cb6-3" data-line-number="3"><span class="co">#&gt; [7] "geom"</span></a></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" data-line-number="1">race_raster_from_vect =<span class="st"> </span><span class="kw"><a href="../reference/zones_to_raster.html">zones_to_raster</a></span>(<span class="dt">v =</span> vect_data,</a>
<a class="sourceLine" id="cb7-2" data-line-number="2">                                        <span class="dt">resolution =</span> <span class="dv">30</span>, </a>
<a class="sourceLine" id="cb7-3" data-line-number="3">                                        <span class="dt">variables =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"ASIAN"</span>, <span class="st">"BLACK"</span>, <span class="st">"HISPANIC"</span>, <span class="st">"OTHER"</span>, <span class="st">"WHITE"</span>))</a></code></pre></div>
<p>Once vector data is rasterized, there is no difference, whether race_raster object or race_raster_from_vect will be used for further analysis.</p>
</div>
</div>
<div id="constructing-racial-landscape" class="section level2">
<h2 class="hasAnchor">
<a href="#constructing-racial-landscape" class="anchor"></a>Constructing racial landscape</h2>
<p>The racial landscape is a high-resolution grid in which each cell contains only inhabitants of a single race.</p>
<p>The racial landscape is constructed based on race-specific grids. Racial composition at each cell is translated to probabilities of drawing a person of a specific race from a cell. Thus, the race label of a cell is a random variable. To obtain a stochastic realization of racial landscape, we use the cell’s race probabilities and a random number generator to randomly assign specific race label to each cell (Monte Carlo procedure).</p>
<p>Multiple draws yield to a series of realization with a slightly different pattern (see example below). The pattern uncertainty occurs only at sub-block scale and only if there is significant sub-block racial diversity.</p>
<p>A single realization-based visualization is sufficiently accurate. For increased accuracy, racial topography is quantified as an ensemble average from multiple realizations. It is recommended to calculate at least 30 realizations.</p>
<p>Realization is constructed using the <code><a href="../reference/create_realizations.html">create_realizations()</a></code> function with two arguments:</p>
<ul>
<li>
<code>x</code> - RasterStack with race-specific population densities assign to each cell</li>
<li>
<code>n</code> - A number of realizations to generate</li>
</ul>
<p>Function returns <em>RasterStack</em> object containing <em>n</em> realizations. Single race label in a racial landscape is assigned based on the order of race-specific grids stored in RasterStack. For example, <em>race_raster</em> object has five layers named: asian, black, hispanic, other, white. The race labels in racial landscape raster will be 1 - asian, 2- black, 3 - hispanic, 4 - other, 5 - white.</p>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" data-line-number="1"><span class="co"># generate 100 realizations based on race_raster object</span></a>
<a class="sourceLine" id="cb8-2" data-line-number="2">real_raster =<span class="st"> </span><span class="kw"><a href="../reference/create_realizations.html">create_realizations</a></span>(<span class="dt">x =</span> race_raster, <span class="dt">n =</span> <span class="dv">100</span>)</a></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" data-line-number="1"><span class="co"># plot five first realizations</span></a>
<a class="sourceLine" id="cb9-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(real_raster[[<span class="dv">1</span><span class="op">:</span><span class="dv">5</span>]], <span class="dt">col =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"#F16667"</span>, <span class="st">"#6EBE44"</span>, <span class="st">"#7E69AF"</span>, <span class="st">"#C77213"</span>, <span class="st">"#F8DF1D"</span>))</a></code></pre></div>
<p><img src="raceland-intro_files/figure-html/fig2-1.png" width="100%" style="display: block; margin: auto;"></p>
<p>The racial landscape provides a skewed visualization of the racial pattern because it does not take into consideration the spatial variability of the population densities. To obtain an accurate depiction of racial distribution, the values of RL must be modified to reflect race and subpopulation densities.</p>
<p>Function <code><a href="../reference/plot_realization.html">plot_realization()</a></code> display realization taking into account also subpopulation density. The function takes three arguments:</p>
<ul>
<li>
<code>x</code> - A raster object (RasterLayer, RasterStack, RasterBrick) with one selected realization representing a racial landscape</li>
<li>
<code>y</code> - RasterStack with race-specific population densities</li>
<li>
<code>hex</code> - A character vector with colors specified in hexadecimal format. Colors should correspond to categories in realization (racial landscape)</li>
</ul>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb10-1" data-line-number="1"><span class="co"># In race_colors first color corresponds to asian, second to black,</span></a>
<a class="sourceLine" id="cb10-2" data-line-number="2"><span class="co"># third to hispanics, fourth to other and fifth to white)</span></a>
<a class="sourceLine" id="cb10-3" data-line-number="3">race_colors =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"#F16667"</span>, <span class="st">"#6EBE44"</span>, <span class="st">"#7E69AF"</span>, <span class="st">"#C77213"</span>, <span class="st">"#F8DF1D"</span>)</a>
<a class="sourceLine" id="cb10-4" data-line-number="4"><span class="kw"><a href="../reference/plot_realization.html">plot_realization</a></span>(<span class="dt">x =</span> real_raster[[<span class="dv">1</span>]], <span class="dt">y =</span> race_raster, <span class="dt">hex =</span> race_colors)</a></code></pre></div>
<p><img src="raceland-intro_files/figure-html/fig3-1.png" width="40%" style="display: block; margin: auto;"></p>
</div>
<div id="describing-racial-patterns-of-racial-landscape" class="section level2">
<h2 class="hasAnchor">
<a href="#describing-racial-patterns-of-racial-landscape" class="anchor"></a>Describing racial patterns of racial landscape</h2>
<p>The exposure matrix describes a racial pattern. In the domain of landscape ecology, landscape pattern can be described by a co-occurrence matrix. The co-occurrence matrix is a tabulation of cells’ adjacencies. Adjacencies between pairs of cells are defined by 4-connectivity rule (There are max. 4 adjacencies: north, east, south, and west cell as is shown in the figure below).</p>
<p><img src="fig1adjacencies.png" width="100%"></p>
<p>The co-occurrence matrix has the size K x K (K - number of categories), is symmetrical and can be calculated for any region regardless of its size or shape.</p>
<p>Exposure matrix is a modification of co-occurrence matrix. The exposure matrix is calculated in the same way as the co-occurrence matrix, but each adjacency contributes as a location-specific value to the matrix instead of the constant value 1. The contributed value is calculated as the average of local population densities in the two adjacent cells.</p>
<p>Let consider an example of the racial landscape presented below. The co-occurrence matrix is constructed using only adjacencies from the racial landscape. To obtain an exposure matrix, each cell in the racial landscape has assigned two types of information: single race class and local population density. Considering two green adjacent cells - this pair will contribute 1 to the co-occurrence matrix (one adjacent pair) and the average from 2 and 1 ((2+1)/2)=1.5) to the exposure matrix.</p>
<p><img src="fig2matrix.png" width="100%"></p>
<div id="calculating-local-subpopulation-densities" class="section level3">
<h3 class="hasAnchor">
<a href="#calculating-local-subpopulation-densities" class="anchor"></a>Calculating local subpopulation densities</h3>
<p>Local densities of subpopulations (race-specific local densities) along with racial landscapes are used to construct the exposure matrix. Local densities are calculated using the <code><a href="../reference/create_densities.html">create_densities()</a></code> function, which requires three arguments:</p>
<ul>
<li>
<code>x</code> - RasterStack with realizations</li>
<li>
<code>y</code> - RasterStack with shares of subpopulations (input data RasterStack)</li>
<li>
<code>window_size</code> - the size, expressed in the number of cells, of a square-shaped window for which local densities will be calculated; it is recommended to use the small window_size, i.e., 10 (<code>window_size=10</code> means that the local densities will be calculated from the area of 10 x 10 cells).</li>
</ul>
<p>The output is a RasterStack with local densities calculated separately for each realization.</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" data-line-number="1">dens_raster =<span class="st"> </span><span class="kw"><a href="../reference/create_densities.html">create_densities</a></span>(real_raster, race_raster, <span class="dt">window_size =</span> <span class="dv">10</span>)</a></code></pre></div>
</div>
<div id="exposure-matrix" class="section level3">
<h3 class="hasAnchor">
<a href="#exposure-matrix" class="anchor"></a>Exposure matrix</h3>
<p>Here we show an example, how the exposure matrix is calculated. Please notice, that the calculation of the exposure matrix is build-in into the <code><a href="../reference/calculate_metrics.html">calculate_metrics()</a></code> function and there is no need to calculate exposure matrix separately.</p>
<p>Exposure matrix can be calculated separately using the <code>get_wecoma()</code> function from the <strong>comat</strong> package. Calculation of exposure matrix requires two arguments:</p>
<ul>
<li>
<code>x</code> - RasterLayer with one selected realization</li>
<li>
<code>y</code> - RasterLayer with local densities corresponding to selected realizations.</li>
</ul>
<p>As default, the exposure matrix with 4-directions adjacencies (<code>neighboorhood = 4</code>) is calculated using the average values from 2 adjacent cells (<code>fun = "mean"</code>).</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" data-line-number="1">exposure_mat =<span class="st"> </span>comat<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/comat/topics/get_wecoma">get_wecoma</a></span>(<span class="dt">x =</span> real_raster[[<span class="dv">1</span>]], <span class="dt">w =</span> dens_raster[[<span class="dv">1</span>]])</a>
<a class="sourceLine" id="cb12-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">colnames</a></span>(exposure_mat) =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"ASIAN"</span>, <span class="st">"BLACK"</span>, <span class="st">"HISPANIC"</span>, <span class="st">"OTHER"</span>, <span class="st">"WHITE"</span>)</a>
<a class="sourceLine" id="cb12-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/colnames">rownames</a></span>(exposure_mat) =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"ASIAN"</span>, <span class="st">"BLACK"</span>, <span class="st">"HISPANIC"</span>, <span class="st">"OTHER"</span>, <span class="st">"WHITE"</span>)</a>
<a class="sourceLine" id="cb12-4" data-line-number="4"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Round">round</a></span>(exposure_mat, <span class="dv">2</span>)</a>
<a class="sourceLine" id="cb12-5" data-line-number="5"><span class="co">#&gt;          ASIAN   BLACK HISPANIC  OTHER   WHITE</span></a>
<a class="sourceLine" id="cb12-6" data-line-number="6"><span class="co">#&gt; ASIAN     0.00   79.59    77.25   1.77   36.84</span></a>
<a class="sourceLine" id="cb12-7" data-line-number="7"><span class="co">#&gt; BLACK    79.59 7247.51  3281.76  99.81 1784.33</span></a>
<a class="sourceLine" id="cb12-8" data-line-number="8"><span class="co">#&gt; HISPANIC 77.25 3281.76  9297.82  91.12 3953.31</span></a>
<a class="sourceLine" id="cb12-9" data-line-number="9"><span class="co">#&gt; OTHER     1.77   99.81    91.12  27.03  123.21</span></a>
<a class="sourceLine" id="cb12-10" data-line-number="10"><span class="co">#&gt; WHITE    36.84 1784.33  3953.31 123.21 3067.33</span></a></code></pre></div>
</div>
<div id="information-theory-metrics-it-metrics" class="section level3">
<h3 class="hasAnchor">
<a href="#information-theory-metrics-it-metrics" class="anchor"></a>Information theory metrics (IT metrics)</h3>
<p>To lucid quantification of racial topography, further compression of the exposure matrix is required. A racial pattern can be described (in the same way as landscape pattern in the domain of landscape ecology) by using Information Theory metrics - entropy and mutual information. Entropy is associated with measuring racial diversity, and mutual information is associated with measuring racial segregation.</p>
<p>Information theory metrics are calculated using function <code><a href="../reference/calculate_metrics.html">calculate_metrics()</a></code>. This function calculates the exposure matrix and summarizes it by calculating four IT-derived matrics: entropy (ent), joint entropy (joinent), conditional entropy (condent) and mutual information (mutinf). The function requires the following arguments:</p>
<ul>
<li>
<code>x</code> - RasterStack with realizations</li>
<li>
<code>w</code> - RasterStack with local densities</li>
<li>
<code>neighboorhood</code> - adjacencies between cells can be defined in 4 directions (<code>neighboorhood = 4</code>) or 8 directions (<code>neighboorhood = 8</code>).</li>
<li>
<code>fun</code> - function to calculate values from adjacent cells to contribute to the exposure matrix, <code>fun = 'mean'</code> calculate average values of population density from two adjacent cells. Other available options are geometric mean (<code>'geometry_mean'</code>) or value from a focal cell (<code>'focal</code>’)</li>
<li>
<code>size = NULL</code> - calculation will be performed for the whole area (see explanation later)</li>
<li>
<code>threshold</code> - the share of NA cells to allow metrics calculation. <code>threshold = 1</code> - calculation will be performed, even if there are 100% cells with NA values (recommended with <code>size = NULL</code>)</li>
</ul>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" data-line-number="1">metr_df =<span class="st"> </span><span class="kw"><a href="../reference/calculate_metrics.html">calculate_metrics</a></span>(<span class="dt">x =</span> real_raster, <span class="dt">w =</span> dens_raster, </a>
<a class="sourceLine" id="cb13-2" data-line-number="2">                            <span class="dt">neighbourhood =</span> <span class="dv">4</span>, <span class="dt">fun =</span> <span class="st">"mean"</span>, </a>
<a class="sourceLine" id="cb13-3" data-line-number="3">                            <span class="dt">size =</span> <span class="ot">NULL</span>, <span class="dt">threshold =</span> <span class="dv">1</span>)</a></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb14-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/utils/topics/head">head</a></span>(metr_df)</a>
<a class="sourceLine" id="cb14-2" data-line-number="2"><span class="co">#&gt;   realization row col      ent  joinent  condent    mutinf</span></a>
<a class="sourceLine" id="cb14-3" data-line-number="3"><span class="co">#&gt; 1           1   1   1 1.637535 3.160893 1.523358 0.1141773</span></a>
<a class="sourceLine" id="cb14-4" data-line-number="4"><span class="co">#&gt; 2           2   1   1 1.632548 3.152273 1.519725 0.1128234</span></a>
<a class="sourceLine" id="cb14-5" data-line-number="5"><span class="co">#&gt; 3           3   1   1 1.628219 3.144617 1.516398 0.1118212</span></a>
<a class="sourceLine" id="cb14-6" data-line-number="6"><span class="co">#&gt; 4           4   1   1 1.640177 3.161263 1.521086 0.1190901</span></a>
<a class="sourceLine" id="cb14-7" data-line-number="7"><span class="co">#&gt; 5           5   1   1 1.614946 3.116732 1.501786 0.1131598</span></a>
<a class="sourceLine" id="cb14-8" data-line-number="8"><span class="co">#&gt; 6           6   1   1 1.617879 3.128985 1.511106 0.1067726</span></a></code></pre></div>
<p>IT metrics are calculated for each realization separately, and in the next step, an average value from all realization is calculated.</p>
<div class="sourceCode" id="cb15"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb15-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/summary">summary</a></span>(metr_df[, <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"ent"</span>, <span class="st">"mutinf"</span>)])</a>
<a class="sourceLine" id="cb15-2" data-line-number="2"><span class="co">#&gt;       ent            mutinf       </span></a>
<a class="sourceLine" id="cb15-3" data-line-number="3"><span class="co">#&gt;  Min.   :1.615   Min.   :0.09611  </span></a>
<a class="sourceLine" id="cb15-4" data-line-number="4"><span class="co">#&gt;  1st Qu.:1.628   1st Qu.:0.10899  </span></a>
<a class="sourceLine" id="cb15-5" data-line-number="5"><span class="co">#&gt;  Median :1.634   Median :0.11373  </span></a>
<a class="sourceLine" id="cb15-6" data-line-number="6"><span class="co">#&gt;  Mean   :1.634   Mean   :0.11433  </span></a>
<a class="sourceLine" id="cb15-7" data-line-number="7"><span class="co">#&gt;  3rd Qu.:1.640   3rd Qu.:0.11907  </span></a>
<a class="sourceLine" id="cb15-8" data-line-number="8"><span class="co">#&gt;  Max.   :1.654   Max.   :0.13607</span></a></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb16-1" data-line-number="1">metr_df <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb16-2" data-line-number="2"><span class="st">  </span><span class="kw">summarise</span>(<span class="dt">mean_ent =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(ent, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb16-3" data-line-number="3">  <span class="dt">sd_ent =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/sd">sd</a></span>(ent, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb16-4" data-line-number="4">  <span class="dt">mean_mutinf =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(mutinf),</a>
<a class="sourceLine" id="cb16-5" data-line-number="5">  <span class="dt">sd_mutinf =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/sd">sd</a></span>(mutinf))</a>
<a class="sourceLine" id="cb16-6" data-line-number="6"><span class="co">#&gt;   mean_ent      sd_ent mean_mutinf   sd_mutinf</span></a>
<a class="sourceLine" id="cb16-7" data-line-number="7"><span class="co">#&gt; 1 1.634423 0.008555783   0.1143306 0.007809951</span></a></code></pre></div>
</div>
</div>
<div id="describing-local-racial-patterns-of-racial-landscape-calculation-at-different-spatial-scales" class="section level2">
<h2 class="hasAnchor">
<a href="#describing-local-racial-patterns-of-racial-landscape-calculation-at-different-spatial-scales" class="anchor"></a>Describing local racial patterns of racial landscape (calculation at different spatial scales)</h2>
<p>Unlike the previous methods, the racial landscape method does not depend on the division into specific zones (census tract, census block, etc.). Calculation of racial diversity (entropy) and racial segregation (mutual information) can be performed for the whole area of interests without introducing any arbitrary divisions.</p>
<p>Racial landscape method allows also for performing calculation at different spatial scales.</p>
<div id="defining-local-patterns" class="section level3">
<h3 class="hasAnchor">
<a href="#defining-local-patterns" class="anchor"></a>Defining local patterns</h3>
<p>Let consider an example presented below. The racial landscape covers the area of 16 by 16 cells. Such an area can be divided into a square-shaped block of cells. Each square of cells will represent a local pattern (a local landscape), and for each local pattern, IT metrics (entropy and mutual information) are calculated. The extent of a local pattern is defined by two parameters: <em>size</em> and <em>shift</em>.</p>
<ul>
<li>
<em>Size</em> parameter, expressed in the numbers of cells, is a length of the side of a square-shaped block of cells. It defines the extent of a local pattern.</li>
<li>
<em>Shift</em> parameter defines the shift between adjacent squares of cells along with the N-S and W-E directions. It describes the density (resolution) of the output grid. The resolution of the output map will be reduced to the new resolution = original resolution x shift. When:
<ul>
<li><p>shift == size - the input map will be divided into a grid of non-overlaping square windows. Each square window defines the extent of a local pattern.</p></li>
<li><p>shift &lt; size - results in the grid of overlapping square windows. A local pattern is calculated from the square window defined by size parameter; the next square window is shifted (in N-S and W-E directions) by the number of cells defined by <em>shift</em> parameter.</p></li>
</ul>
</li>
</ul>
<p>The example presented below consists of the racial landscape 16 by 16 cells. Setting <code>size = 4</code> (and <code>shift= 4</code>) results in dividing the racial landscape into four squared windows, each 4x4 cells. Each window represents a local pattern. For each local pattern, IT metrics can be calculated, and the results will be assigned to the resultant grid of square windows. In fact, the original racial landscape with 16x16 cells is reduced to the 2x2 ‘large cells’.</p>
<p>Setting <code>size=4</code> and <code>shift = 2</code> results in overlapping square windows. First, the window of the size 4x4 defines the local pattern (see dark blue square). In the next step, this window is shifted by two cells to the right, and the new local pattern is selected (see the light blue square). It will create a resultant grid of the cell size defined by the shift parameter.</p>
<p><img src="fig3size_shift.png" width="100%"></p>
</div>
<div id="calculate-it-metrics-from-local-patterns-1" class="section level3">
<h3 class="hasAnchor">
<a href="#calculate-it-metrics-from-local-patterns-1" class="anchor"></a>Calculate IT metrics from local patterns (1)</h3>
<p>The <code><a href="../reference/create_grid.html">create_grid()</a></code> function creates spatial object with a grid (each ‘cell’ is defined by size and shift). This function requires the RasterStack object with realizations (racial landscapes) and size parameter. If the shift parameter is not set, it is assumed that <code>size=shift</code>.</p>
<p>Below such grid is imposed into the racial landscape to show local patterns.</p>
<div class="sourceCode" id="cb17"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb17-1" data-line-number="1">grid_sf =<span class="st"> </span><span class="kw"><a href="../reference/create_grid.html">create_grid</a></span>(real_raster, <span class="dt">size =</span> <span class="dv">20</span>)</a>
<a class="sourceLine" id="cb17-2" data-line-number="2"><span class="kw"><a href="../reference/plot_realization.html">plot_realization</a></span>(real_raster[[<span class="dv">1</span>]], race_raster, <span class="dt">hex =</span> race_colors)</a>
<a class="sourceLine" id="cb17-3" data-line-number="3"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(<span class="kw">st_geometry</span>(grid_sf), <span class="dt">add =</span> <span class="ot">TRUE</span>, <span class="dt">lwd =</span> <span class="dv">2</span>)</a></code></pre></div>
<p><img src="raceland-intro_files/figure-html/fig5-1.png" width="40%" style="display: block; margin: auto;"></p>
<p>The <code><a href="../reference/calculate_metrics.html">calculate_metrics()</a></code> function is used to calculate IT metrics. Parameter <code>size=20</code> means that the area of interests will be divided into a grid of local patterns of the size 20x20 cells (which in this case corresponds to the square of 0.6 km x 0.6km). The <code>neighboorhood = 4</code> defines that adjacencies between cells are defined in four directions, <code>fun="mean"</code> calculate average values of population density from adjacent cells, <code>threshold = 0.5</code> - calculation will be performed if there is at least 50% of non-NA cells.</p>
<p>IT metrics are calculated for each local pattern for each realization. The output table will have 900 rows (there are nine local patterns of size 20x20 cells and 100 realizations).</p>
<div class="sourceCode" id="cb18"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb18-1" data-line-number="1">metr_df_<span class="dv">20</span> =<span class="st"> </span><span class="kw"><a href="../reference/calculate_metrics.html">calculate_metrics</a></span>(<span class="dt">x =</span> real_raster, <span class="dt">w =</span> dens_raster, </a>
<a class="sourceLine" id="cb18-2" data-line-number="2">                               <span class="dt">neighbourhood =</span> <span class="dv">4</span>, <span class="dt">fun =</span> <span class="st">"mean"</span>, </a>
<a class="sourceLine" id="cb18-3" data-line-number="3">                               <span class="dt">size =</span> <span class="dv">20</span>, <span class="dt">threshold =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb18-4" data-line-number="4">metr_df_<span class="dv">20</span>[metr_df_<span class="dv">20</span><span class="op">$</span>realization <span class="op">==</span><span class="st"> </span><span class="dv">1</span>, ]</a>
<a class="sourceLine" id="cb18-5" data-line-number="5"><span class="co">#&gt;   realization row col      ent  joinent  condent     mutinf</span></a>
<a class="sourceLine" id="cb18-6" data-line-number="6"><span class="co">#&gt; 1           1   1   1 1.275316 2.524824 1.249507 0.02580922</span></a>
<a class="sourceLine" id="cb18-7" data-line-number="7"><span class="co">#&gt; 2           1   1   2 1.595575 3.026327 1.430752 0.16482253</span></a>
<a class="sourceLine" id="cb18-8" data-line-number="8"><span class="co">#&gt; 3           1   1   3 1.427468 2.817515 1.390047 0.03742105</span></a>
<a class="sourceLine" id="cb18-9" data-line-number="9"><span class="co">#&gt; 4           1   2   1 1.622238 3.126725 1.504487 0.11775092</span></a>
<a class="sourceLine" id="cb18-10" data-line-number="10"><span class="co">#&gt; 5           1   2   2 1.535015 3.036517 1.501502 0.03351266</span></a>
<a class="sourceLine" id="cb18-11" data-line-number="11"><span class="co">#&gt; 6           1   2   3 1.486060 2.735239 1.249179 0.23688131</span></a>
<a class="sourceLine" id="cb18-12" data-line-number="12"><span class="co">#&gt; 7           1   3   1 1.482890 2.817528 1.334638 0.14825201</span></a>
<a class="sourceLine" id="cb18-13" data-line-number="13"><span class="co">#&gt; 8           1   3   2 1.536434 3.060517 1.524084 0.01234987</span></a>
<a class="sourceLine" id="cb18-14" data-line-number="14"><span class="co">#&gt; 9           1   3   3 1.422271 2.786665 1.364394 0.05787737</span></a></code></pre></div>
<p>Racial topography at the analyzed scale is quantified as an ensemble average from multiple realizations. First, for each square window is calculated the average value of entropy and mutual information based on 100 realizations. The table below shows the mean (<code>ent_mean</code>, <code>mutinf_mean</code>) and standard deviation (<code>ent_sd</code>, <code>mutinf_sd</code>) values for each square window.</p>
<div class="sourceCode" id="cb19"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb19-1" data-line-number="1">smr =<span class="st"> </span>metr_df_<span class="dv">20</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-2" data-line-number="2"><span class="st">  </span><span class="kw">group_by</span>(row, col) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb19-3" data-line-number="3"><span class="st">  </span><span class="kw">summarize</span>(</a>
<a class="sourceLine" id="cb19-4" data-line-number="4">    <span class="dt">ent_mean =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(ent, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb19-5" data-line-number="5">    <span class="dt">ent_sd =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/sd">sd</a></span>(ent, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb19-6" data-line-number="6">    <span class="dt">mutinf_mean =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(mutinf, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb19-7" data-line-number="7">    <span class="dt">mutinf_sd =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/sd">sd</a></span>(mutinf, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb19-8" data-line-number="8">  )</a>
<a class="sourceLine" id="cb19-9" data-line-number="9">smr</a>
<a class="sourceLine" id="cb19-10" data-line-number="10"><span class="co">#&gt; # A tibble: 9 x 6</span></a>
<a class="sourceLine" id="cb19-11" data-line-number="11"><span class="co">#&gt; # Groups:   row [3]</span></a>
<a class="sourceLine" id="cb19-12" data-line-number="12"><span class="co">#&gt;     row   col ent_mean ent_sd mutinf_mean mutinf_sd</span></a>
<a class="sourceLine" id="cb19-13" data-line-number="13"><span class="co">#&gt;   &lt;dbl&gt; &lt;dbl&gt;    &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb19-14" data-line-number="14"><span class="co">#&gt; 1     1     1     1.26 0.0448      0.0190   0.00868</span></a>
<a class="sourceLine" id="cb19-15" data-line-number="15"><span class="co">#&gt; 2     1     2     1.59 0.0106      0.159    0.0270 </span></a>
<a class="sourceLine" id="cb19-16" data-line-number="16"><span class="co">#&gt; 3     1     3     1.42 0.0282      0.0482   0.0148 </span></a>
<a class="sourceLine" id="cb19-17" data-line-number="17"><span class="co">#&gt; 4     2     1     1.60 0.0279      0.154    0.0337 </span></a>
<a class="sourceLine" id="cb19-18" data-line-number="18"><span class="co">#&gt; 5     2     2     1.52 0.0245      0.0356   0.0123 </span></a>
<a class="sourceLine" id="cb19-19" data-line-number="19"><span class="co">#&gt; 6     2     3     1.52 0.0299      0.152    0.0300 </span></a>
<a class="sourceLine" id="cb19-20" data-line-number="20"><span class="co">#&gt; 7     3     1     1.38 0.0517      0.149    0.0419 </span></a>
<a class="sourceLine" id="cb19-21" data-line-number="21"><span class="co">#&gt; 8     3     2     1.54 0.0288      0.0159   0.00716</span></a>
<a class="sourceLine" id="cb19-22" data-line-number="22"><span class="co">#&gt; 9     3     3     1.42 0.0277      0.0476   0.0130</span></a></code></pre></div>
<p>Then the averages from the mean values of entropy and mutual information are calculated.</p>
<div class="sourceCode" id="cb20"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb20-1" data-line-number="1">smr <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-2" data-line-number="2"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-3" data-line-number="3"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>row, <span class="op">-</span>col) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb20-4" data-line-number="4"><span class="st">  </span><span class="kw">summarise_all</span>(mean)</a>
<a class="sourceLine" id="cb20-5" data-line-number="5"><span class="co">#&gt; # A tibble: 1 x 4</span></a>
<a class="sourceLine" id="cb20-6" data-line-number="6"><span class="co">#&gt;   ent_mean ent_sd mutinf_mean mutinf_sd</span></a>
<a class="sourceLine" id="cb20-7" data-line-number="7"><span class="co">#&gt;      &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb20-8" data-line-number="8"><span class="co">#&gt; 1     1.47 0.0304      0.0867    0.0209</span></a></code></pre></div>
</div>
<div id="racial-diversity-segregation-classification" class="section level3">
<h3 class="hasAnchor">
<a href="#racial-diversity-segregation-classification" class="anchor"></a>Racial diversity-segregation classification</h3>
<p>The bivariate classification shows at the same times changes in racial diversity and segregation. The values of entropy (the measure of racial diversity) and mutual information (the measure of racial segregation) are reclassified into nine classes coded by nine colors.</p>
<p><img src="fig4_bivariate.png" width="40%"></p>
<div class="sourceCode" id="cb21"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb21-1" data-line-number="1"><span class="co"># n is a number of categories in racial landscape</span></a>
<a class="sourceLine" id="cb21-2" data-line-number="2">bivariate_classification =<span class="st"> </span><span class="cf">function</span>(entropy, mutual_information, n) {</a>
<a class="sourceLine" id="cb21-3" data-line-number="3">  </a>
<a class="sourceLine" id="cb21-4" data-line-number="4">  <span class="co"># calculate bivariate classification</span></a>
<a class="sourceLine" id="cb21-5" data-line-number="5">  nent =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">log2</a></span>(n)</a>
<a class="sourceLine" id="cb21-6" data-line-number="6">  ent_cat =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cut">cut</a></span>(entropy, <span class="dt">breaks =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="fl">0.66</span>, <span class="fl">1.33</span>, nent), <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">1</span>, <span class="dv">2</span>, <span class="dv">3</span>), </a>
<a class="sourceLine" id="cb21-7" data-line-number="7">                <span class="dt">include.lowest =</span> <span class="ot">TRUE</span>, <span class="dt">right =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb21-8" data-line-number="8">  ent_cat =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/integer">as.integer</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">as.character</a></span>(ent_cat))</a>
<a class="sourceLine" id="cb21-9" data-line-number="9">  </a>
<a class="sourceLine" id="cb21-10" data-line-number="10">  mut_cat =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/cut">cut</a></span>(mutual_information, <span class="dt">breaks =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">0</span>, <span class="fl">0.33</span>, <span class="fl">0.66</span>, <span class="dv">1</span>), <span class="dt">labels =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="dv">10</span>, <span class="dv">20</span>, <span class="dv">30</span>), </a>
<a class="sourceLine" id="cb21-11" data-line-number="11">                <span class="dt">include.lowest =</span> <span class="ot">TRUE</span>, <span class="dt">right =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb21-12" data-line-number="12">  mut_cat =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/integer">as.integer</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/character">as.character</a></span>(mut_cat))</a>
<a class="sourceLine" id="cb21-13" data-line-number="13">  </a>
<a class="sourceLine" id="cb21-14" data-line-number="14">  bivar_cls =<span class="st"> </span>mut_cat <span class="op">+</span><span class="st"> </span>ent_cat</a>
<a class="sourceLine" id="cb21-15" data-line-number="15">  bivar_cls =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/factor">as.factor</a></span>(bivar_cls)</a>
<a class="sourceLine" id="cb21-16" data-line-number="16">  </a>
<a class="sourceLine" id="cb21-17" data-line-number="17">  <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/function">return</a></span>(bivar_cls)</a>
<a class="sourceLine" id="cb21-18" data-line-number="18">}</a></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb22-1" data-line-number="1">smr<span class="op">$</span>bivar_cls =<span class="st"> </span><span class="kw">bivariate_classification</span>(<span class="dt">entropy =</span> smr<span class="op">$</span>ent_mean, </a>
<a class="sourceLine" id="cb22-2" data-line-number="2">                                         <span class="dt">mutual_information =</span> smr<span class="op">$</span>mutinf_mean,</a>
<a class="sourceLine" id="cb22-3" data-line-number="3">                                         <span class="dt">n =</span> <span class="kw">nlayers</span>(race_raster))</a></code></pre></div>
</div>
<div id="mapping-local-racial-diversity-and-racial-segregation" class="section level3">
<h3 class="hasAnchor">
<a href="#mapping-local-racial-diversity-and-racial-segregation" class="anchor"></a>Mapping local racial diversity and racial segregation</h3>
<p>The average value of entropy and mutual information calculated for each square-shaped window from all realizations can be joined to the spatial grid object. Such operation allows for mapping metrics and shows how segregation and racial diversity change over the area.</p>
<div class="sourceCode" id="cb23"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb23-1" data-line-number="1">attr_grid =<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(grid_sf, smr, <span class="dt">by =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"row"</span>, <span class="st">"col"</span>))</a></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb24-1" data-line-number="1">ent_breaks =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">2</span>, <span class="fl">0.25</span>), <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/Log">log2</a></span>(<span class="kw">nlayers</span>(race_raster)))</a>
<a class="sourceLine" id="cb24-2" data-line-number="2">mut_breaks =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/seq">seq</a></span>(<span class="dv">0</span>, <span class="dv">1</span>, <span class="fl">0.1</span>)</a></code></pre></div>
<div class="sourceCode" id="cb25"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb25-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(attr_grid[<span class="st">"ent_mean"</span>], <span class="dt">breaks =</span> ent_breaks, <span class="dt">key.pos =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb25-2" data-line-number="2">     <span class="co"># pal = rev(brewer.pal(length(ent_breaks) - 1, name = "RdBu")),</span></a>
<a class="sourceLine" id="cb25-3" data-line-number="3">     <span class="dt">pal =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rev">rev</a></span>(grDevices<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/palettes">hcl.colors</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(ent_breaks) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">palette =</span> <span class="st">"RdBu"</span>)),</a>
<a class="sourceLine" id="cb25-4" data-line-number="4">     <span class="dt">bty =</span> <span class="st">"n"</span>, <span class="dt">main =</span> <span class="st">"Racial diversity (Entropy)"</span>)</a></code></pre></div>
<p><img src="raceland-intro_files/figure-html/unnamed-chunk-28-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb26"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb26-1" data-line-number="1"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(attr_grid[<span class="st">"mutinf_mean"</span>], <span class="dt">breaks =</span> mut_breaks, <span class="dt">key.pos =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb26-2" data-line-number="2">     <span class="co"># pal = rev(brewer.pal(length(mut_breaks) - 1, name = "RdBu")), </span></a>
<a class="sourceLine" id="cb26-3" data-line-number="3">     <span class="dt">pal =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rev">rev</a></span>(grDevices<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/palettes">hcl.colors</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(mut_breaks) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">palette =</span> <span class="st">"RdBu"</span>)),</a>
<a class="sourceLine" id="cb26-4" data-line-number="4">     <span class="dt">bty =</span> <span class="st">"n"</span>, <span class="dt">main =</span> <span class="st">"Racial diversity (Entropy)"</span>)</a></code></pre></div>
<p><img src="raceland-intro_files/figure-html/unnamed-chunk-29-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb27"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb27-1" data-line-number="1">biv_colors =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"11"</span> =<span class="st"> "#e8e8e8"</span>, <span class="st">"12"</span> =<span class="st"> "#e4acac"</span>, <span class="st">"13"</span> =<span class="st"> "#c85a5a"</span>, <span class="st">"21"</span> =<span class="st"> "#b0d5df"</span>,</a>
<a class="sourceLine" id="cb27-2" data-line-number="2">               <span class="st">"22"</span> =<span class="st"> "#ad9ea5"</span>, <span class="st">"23"</span> =<span class="st"> "#985356"</span>, <span class="st">"31"</span> =<span class="st"> "#64acbe"</span>, <span class="st">"32"</span>=<span class="st"> "#627f8c"</span>, </a>
<a class="sourceLine" id="cb27-3" data-line-number="3">               <span class="st">"33"</span> =<span class="st"> "#574249"</span>)</a>
<a class="sourceLine" id="cb27-4" data-line-number="4">bcat =<span class="st"> </span>biv_colors[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(biv_colors)<span class="op">%in%</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(attr_grid<span class="op">$</span>bivar_cls)]</a>
<a class="sourceLine" id="cb27-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(attr_grid[<span class="st">"bivar_cls"</span>], <span class="dt">pal =</span> bcat, <span class="dt">main =</span> <span class="st">"Racial diversity and residential segregation"</span>)</a></code></pre></div>
<p><img src="raceland-intro_files/figure-html/unnamed-chunk-30-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
<div id="calculate-it-metrics-from-local-patterns-2" class="section level3">
<h3 class="hasAnchor">
<a href="#calculate-it-metrics-from-local-patterns-2" class="anchor"></a>Calculate IT metrics from local patterns (2)</h3>
<p>The next example shows how to calculate a local pattern using overlapping windows. This option is recommended to use, especially for a larger size value. Using overlapping windows does not introduce arbitrary boundaries.</p>
<p>To obtain overlapping windows the <code><a href="../reference/calculate_metrics.html">calculate_metrics()</a></code> function requires additional argument - <code>shift</code>.</p>
<div class="sourceCode" id="cb28"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb28-1" data-line-number="1">metr_df_<span class="dv">10</span> =<span class="st"> </span><span class="kw"><a href="../reference/calculate_metrics.html">calculate_metrics</a></span>(<span class="dt">x =</span> real_raster, <span class="dt">w =</span> dens_raster, </a>
<a class="sourceLine" id="cb28-2" data-line-number="2">                               <span class="dt">neighbourhood =</span> <span class="dv">4</span>, <span class="dt">fun =</span> <span class="st">"mean"</span>, </a>
<a class="sourceLine" id="cb28-3" data-line-number="3">                               <span class="dt">size =</span> <span class="dv">20</span>, <span class="dt">shift =</span> <span class="dv">10</span>, <span class="dt">threshold =</span> <span class="fl">0.5</span>)</a>
<a class="sourceLine" id="cb28-4" data-line-number="4"></a>
<a class="sourceLine" id="cb28-5" data-line-number="5">smr10 =<span class="st"> </span>metr_df_<span class="dv">10</span> <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-6" data-line-number="6"><span class="st">  </span><span class="kw">group_by</span>(row, col) <span class="op">%&gt;%</span></a>
<a class="sourceLine" id="cb28-7" data-line-number="7"><span class="st">  </span><span class="kw">summarize</span>(</a>
<a class="sourceLine" id="cb28-8" data-line-number="8">    <span class="dt">ent_mean =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(ent, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb28-9" data-line-number="9">    <span class="dt">ent_sd =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/sd">sd</a></span>(ent, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb28-10" data-line-number="10">    <span class="dt">mutinf_mean =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/mean">mean</a></span>(mutinf, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>),</a>
<a class="sourceLine" id="cb28-11" data-line-number="11">    <span class="dt">mutinf_sd =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/stats/topics/sd">sd</a></span>(mutinf, <span class="dt">na.rm =</span> <span class="ot">TRUE</span>)</a>
<a class="sourceLine" id="cb28-12" data-line-number="12">  )</a>
<a class="sourceLine" id="cb28-13" data-line-number="13"></a>
<a class="sourceLine" id="cb28-14" data-line-number="14">smr10 <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-15" data-line-number="15"><span class="st">  </span><span class="kw">ungroup</span>() <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-16" data-line-number="16"><span class="st">  </span><span class="kw">select</span>(<span class="op">-</span>row, <span class="op">-</span>col) <span class="op">%&gt;%</span><span class="st"> </span></a>
<a class="sourceLine" id="cb28-17" data-line-number="17"><span class="st">  </span><span class="kw">summarise_all</span>(mean)</a>
<a class="sourceLine" id="cb28-18" data-line-number="18"><span class="co">#&gt; # A tibble: 1 x 4</span></a>
<a class="sourceLine" id="cb28-19" data-line-number="19"><span class="co">#&gt;   ent_mean ent_sd mutinf_mean mutinf_sd</span></a>
<a class="sourceLine" id="cb28-20" data-line-number="20"><span class="co">#&gt;      &lt;dbl&gt;  &lt;dbl&gt;       &lt;dbl&gt;     &lt;dbl&gt;</span></a>
<a class="sourceLine" id="cb28-21" data-line-number="21"><span class="co">#&gt; 1     1.48 0.0327      0.0832    0.0219</span></a>
<a class="sourceLine" id="cb28-22" data-line-number="22"></a>
<a class="sourceLine" id="cb28-23" data-line-number="23"><span class="co"># calculate bivariate classification</span></a>
<a class="sourceLine" id="cb28-24" data-line-number="24">smr10<span class="op">$</span>bivar_cls =<span class="st"> </span><span class="kw">bivariate_classification</span>(</a>
<a class="sourceLine" id="cb28-25" data-line-number="25">  <span class="dt">entropy =</span> smr<span class="op">$</span>ent_mean,</a>
<a class="sourceLine" id="cb28-26" data-line-number="26">  <span class="dt">mutual_information =</span> smr<span class="op">$</span>mutinf_mean,</a>
<a class="sourceLine" id="cb28-27" data-line-number="27">  <span class="dt">n =</span> <span class="kw">nlayers</span>(race_raster)</a>
<a class="sourceLine" id="cb28-28" data-line-number="28">)</a>
<a class="sourceLine" id="cb28-29" data-line-number="29"></a>
<a class="sourceLine" id="cb28-30" data-line-number="30"><span class="co"># create spatial grid object</span></a>
<a class="sourceLine" id="cb28-31" data-line-number="31">grid_sf10 =<span class="st"> </span><span class="kw"><a href="../reference/create_grid.html">create_grid</a></span>(real_raster, <span class="dt">size =</span> <span class="dv">20</span>, <span class="dt">shift =</span> <span class="dv">10</span>)</a>
<a class="sourceLine" id="cb28-32" data-line-number="32"></a>
<a class="sourceLine" id="cb28-33" data-line-number="33">attr_grid10 =<span class="st"> </span>dplyr<span class="op">::</span><span class="kw"><a href="https://dplyr.tidyverse.org/reference/join.html">left_join</a></span>(grid_sf10, smr10, <span class="dt">by =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"row"</span>, <span class="st">"col"</span>))</a></code></pre></div>
<div id="mapping-local-racial-diversity-and-racial-segregation-1" class="section level4">
<h4 class="hasAnchor">
<a href="#mapping-local-racial-diversity-and-racial-segregation-1" class="anchor"></a>Mapping local racial diversity and racial segregation</h4>
<div class="sourceCode" id="cb29"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb29-1" data-line-number="1"><span class="co">#plot(attr_grid["ent_mean"], key.pos = 1, bty="n", box=FALSE, main = "Racial diversity (Entropy)")</span></a>
<a class="sourceLine" id="cb29-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(attr_grid10[<span class="st">"ent_mean"</span>], <span class="dt">breaks =</span> ent_breaks, <span class="dt">key.pos =</span> <span class="dv">1</span>, </a>
<a class="sourceLine" id="cb29-3" data-line-number="3">     <span class="co"># pal = rev(brewer.pal(length(ent_breaks) - 1, name = "RdBu")), </span></a>
<a class="sourceLine" id="cb29-4" data-line-number="4">     <span class="dt">pal =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rev">rev</a></span>(grDevices<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/palettes">hcl.colors</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(ent_breaks) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">palette =</span> <span class="st">"RdBu"</span>)),</a>
<a class="sourceLine" id="cb29-5" data-line-number="5">     <span class="dt">bty =</span> <span class="st">"n"</span>, <span class="dt">main =</span> <span class="st">"Racial diversity (Entropy)"</span>)</a></code></pre></div>
<p><img src="raceland-intro_files/figure-html/unnamed-chunk-32-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb30"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb30-1" data-line-number="1"><span class="co">#plot(attr_grid["mutinf_mean"], key.pos = 1, main = "Racial segregation (Mutual Information)")</span></a>
<a class="sourceLine" id="cb30-2" data-line-number="2"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(attr_grid10[<span class="st">"mutinf_mean"</span>], <span class="dt">breaks =</span> mut_breaks, <span class="dt">key.pos =</span> <span class="dv">1</span>,</a>
<a class="sourceLine" id="cb30-3" data-line-number="3">     <span class="co"># pal = rev(brewer.pal(length(mut_breaks) - 1, name = "RdBu")), </span></a>
<a class="sourceLine" id="cb30-4" data-line-number="4">     <span class="dt">pal =</span> <span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/rev">rev</a></span>(grDevices<span class="op">::</span><span class="kw"><a href="https://www.rdocumentation.org/packages/grDevices/topics/palettes">hcl.colors</a></span>(<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/length">length</a></span>(mut_breaks) <span class="op">-</span><span class="st"> </span><span class="dv">1</span>, <span class="dt">palette =</span> <span class="st">"RdBu"</span>)),</a>
<a class="sourceLine" id="cb30-5" data-line-number="5">     <span class="dt">bty =</span> <span class="st">"n"</span>, <span class="dt">main =</span> <span class="st">"Racial diversity (Entropy)"</span>)</a></code></pre></div>
<p><img src="raceland-intro_files/figure-html/unnamed-chunk-33-1.png" width="576" style="display: block; margin: auto;"></p>
<div class="sourceCode" id="cb31"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb31-1" data-line-number="1">biv_colors =<span class="st"> </span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/c">c</a></span>(<span class="st">"11"</span> =<span class="st"> "#e8e8e8"</span>, <span class="st">"12"</span> =<span class="st"> "#e4acac"</span>, <span class="st">"13"</span> =<span class="st"> "#c85a5a"</span>, <span class="st">"21"</span> =<span class="st"> "#b0d5df"</span>, </a>
<a class="sourceLine" id="cb31-2" data-line-number="2">               <span class="st">"22"</span> =<span class="st"> "#ad9ea5"</span>, <span class="st">"23"</span> =<span class="st"> "#985356"</span>, <span class="st">"31"</span> =<span class="st"> "#64acbe"</span>,<span class="st">"32"</span> =<span class="st"> "#627f8c"</span>,</a>
<a class="sourceLine" id="cb31-3" data-line-number="3">               <span class="st">"33"</span> =<span class="st"> "#574249"</span>)</a>
<a class="sourceLine" id="cb31-4" data-line-number="4">bcat =<span class="st"> </span>biv_colors[<span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/names">names</a></span>(biv_colors)<span class="op">%in%</span><span class="kw"><a href="https://www.rdocumentation.org/packages/base/topics/unique">unique</a></span>(attr_grid10<span class="op">$</span>bivar_cls)]</a>
<a class="sourceLine" id="cb31-5" data-line-number="5"><span class="kw"><a href="https://www.rdocumentation.org/packages/graphics/topics/plot">plot</a></span>(attr_grid10[<span class="st">"bivar_cls"</span>], <span class="dt">pal =</span> bcat, <span class="dt">main =</span> <span class="st">"Racial diversity and residential segregation"</span>)</a></code></pre></div>
<p><img src="raceland-intro_files/figure-html/unnamed-chunk-34-1.png" width="576" style="display: block; margin: auto;"></p>
</div>
</div>
</div>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">
        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#introduction">INTRODUCTION</a></li>
      <li>
<a href="#a-computational-framework">A COMPUTATIONAL FRAMEWORK</a><ul class="nav nav-pills nav-stacked">
<li><a href="#input-data">Input data</a></li>
      <li><a href="#constructing-racial-landscape">Constructing racial landscape</a></li>
      <li><a href="#describing-racial-patterns-of-racial-landscape">Describing racial patterns of racial landscape</a></li>
      <li><a href="#describing-local-racial-patterns-of-racial-landscape-calculation-at-different-spatial-scales">Describing local racial patterns of racial landscape (calculation at different spatial scales)</a></li>
      </ul>
</li>
      </ul>
</div>
      </div>

</div>


      <footer><div class="copyright">
  <p>Developed by Jakub Nowosad, Anna Dmowska, Tomasz Stepinski.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.3.0.</p>
</div>
      </footer>
</div>

  

  </body>
</html>
